<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <meta name="description" content="Plataforma de estudio para el Examen de Auxiliar de Farmacia en Chile.">
    <title>Auxiliar Pro | Credencial 2026</title>

    <script src="https://cdn.tailwindcss.com"></script>
    <script>
      tailwind.config = {
        theme: {
          extend: {
            colors: {
              'aux-dark': '#0E172A',   
              'aux-green': '#2A9974',  
              'aux-gray': '#BDC3C1',
              'aux-light': '#F8FAFC',
            },
            fontFamily: { sans: ['Inter', 'sans-serif'] },
            animation: { 'fade-in': 'fadeIn 0.3s ease-out forwards' },
            keyframes: { fadeIn: { '0%': { opacity: '0' }, '100%': { opacity: '1' } } }
          }
        }
      }
    </script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <script src="https://unpkg.com/@phosphor-icons/web"></script>
    
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <style>
      body { -webkit-tap-highlight-color: transparent; }
      .no-scrollbar::-webkit-scrollbar { display: none; }
      
      /* Estilo Sello de Agua */
      .watermark-container {
          position: relative;
          overflow: hidden;
          background-color: rgba(42, 153, 116, 0.03);
          border: 1px solid rgba(42, 153, 116, 0.1);
      }
      .watermark-icon {
          position: absolute;
          font-weight: 900;
          opacity: 0.06;
          color: #2A9974;
          z-index: 0;
          pointer-events: none;
      }
      /* HTML content styles */
      .html-content a { color: #2A9974; text-decoration: none; font-weight: 600; }
      .html-content ul { list-style-type: disc; padding-left: 1.2rem; margin-top: 0.5rem; }
    </style>
</head>
<body class="bg-white text-aux-dark antialiased min-h-screen flex flex-col items-center justify-center font-sans">

    <div id="root" class="w-full h-full flex justify-center items-center"></div>

    <script>
        window.onerror = function(message, source, lineno, colno, error) {
            document.body.innerHTML = '<div style="padding:20px; color:red; text-align:center;"><h2>Ups! Algo falló al cargar.</h2><p>'+message+'</p></div>';
        };
    </script>

    <script type="text/babel">
        const { useState, useEffect } = React;
        const LOCAL_STORAGE_KEY = 'auxiliar_pro_data';
        
        // --- URLs CONFIGURADAS ---
        const LOGO_URL = "https://raw.githubusercontent.com/marcar1972-cyber/Auxiliar--pro/34923cb127c2feede55ec712bdc0261f1b23da3c/logo_auxiliarpro_3_400x240_ajustado.png";
        const DERMO_URL = "https://auxiliar-dermocheck.vercel.app";

        // --- DATOS ESTÁTICOS ---
        const BLOG_POSTS = [
            { id: 'art1', date: '04 DIC', category: 'Legal', title: 'Decreto 466: La "Biblia" de la Farmacia', excerpt: 'Reglamento fundamental para aprobar.', content: '<h1>Decreto 466</h1><p>Define roles, temperaturas y leyes...</p>' },
            { id: 'art2', date: '02 DIC', category: 'Técnico', title: 'Ley de Fármacos y Bioequivalencia', excerpt: 'Lo que debes saber de la Ley 20.724.', content: '<h1>Ley 20.724</h1><p>Cambios en bioequivalencia y venta directa...</p>' }
        ];

        const FAQS = [
            { q: "Descripción del Trámite", a: "La certificación de competencias consiste en una solicitud ante la SEREMI de Salud." },
            { q: "¿Dónde hago el trámite?", a: "Disponible en línea en el portal <strong>SEREMI en Línea</strong>." },
            { q: "Requisitos", a: "Licencia de enseñanza media, certificado laboral de 1 año y foto carnet." }
        ];

        const PDF_DOCS = [
            { title: 'Ley 20.724 (Fármacos)', file: 'ley_20724.pdf' },
            { title: 'Decreto 466 (Farmacias)', file: 'decreto_466.pdf' }
        ];

        const LEVELS = [
            { id: 1, title: 'Prueba Diagnóstico', desc: 'Conceptos básicos.', iconBg: 'bg-orange-500', qCount: 10, passingScore: 6, questions: [{ id: 101, text: '¿Quién es el responsable técnico?', options: ['Dueño', 'Auxiliar', 'QF', 'Gerente'], correctIndex: 2 }, { id: 102, text: 'Rango frío:', options: ['0-5', '2-8', '8-15', 'Ambiente'], correctIndex: 1 }] },
            { id: 2, title: 'Nivel Intermedio', desc: 'Legislación.', iconBg: 'bg-slate-400', qCount: 15, passingScore: 9, questions: Array(15).fill({ id: 200, text: 'Pregunta N2', options: ['A', 'B', 'C', 'D'], correctIndex: 0 }) },
            { id: 3, title: 'Nivel Avanzado', desc: 'Farmacología.', iconBg: 'bg-yellow-500', qCount: 25, passingScore: 18, questions: Array(25).fill({ id: 300, text: 'Pregunta N3', options: ['A', 'B', 'C', 'D'], correctIndex: 0 }) },
            { id: 4, title: 'Simulacro Final', desc: 'Examen Seremi.', iconBg: 'bg-aux-dark', qCount: 40, passingScore: 28, questions: Array(40).fill({ id: 400, text: 'Pregunta N4', options: ['A', 'B', 'C', 'D'], correctIndex: 0 }) }
        ];

        // --- COMPONENTES UI ---
        const Icon = ({ name, className }) => <i className={`ph-${name} ${className || ''} text-lg`}></i>;
        
        const Button = ({ onClick, children, variant = 'primary', className = '', fullWidth = false }) => {
            const base = "flex items-center justify-center gap-2 rounded-xl font-bold transition-all active:scale-95 text-sm";
            const variants = {
                primary: "bg-aux-dark text-white hover:bg-slate-800 shadow-md py-3 px-6",
                green: "bg-aux-green text-white hover:bg-emerald-600 shadow-md py-3 px-6",
                secondary: "bg-white border-2 border-slate-200 text-slate-600 hover:border-aux-green hover:text-aux-green py-3 px-6",
                danger: "bg-red-50 text-red-500 border border-red-100 py-3 px-6"
            };
            return <button onClick={onClick} className={`${base} ${variants[variant]} ${fullWidth ? 'w-full' : ''} ${className}`}>{children}</button>;
        };

        const Accordion = ({ title, content }) => {
            const [isOpen, setIsOpen] = useState(false);
            return (
                <div className="border-b border-slate-100 last:border-0">
                    <button onClick={() => setIsOpen(!isOpen)} className="w-full flex justify-between items-center py-4 text-left font-medium text-slate-700 hover:text-aux-green transition-colors">
                        {title}
                        <Icon name="caret-down" className={`transition-transform duration-300 ${isOpen ? 'rotate-180' : ''}`} />
                    </button>
                    <div className={`overflow-hidden transition-all duration-300 ${isOpen ? 'max-h-96 pb-4' : 'max-h-0'}`}>
                        <div className="text-sm text-slate-500 leading-relaxed html-content" dangerouslySetInnerHTML={{__html: content}}></div>
                    </div>
                </div>
            );
        };

        // --- HEADER CON MEDIDAS EXACTAS ---
        const Header = ({ setView, user, setActiveModal }) => (
            <header className="bg-white shadow-sm h-[80px] px-4 md:px-12 flex justify-between items-center sticky top-0 z-50 transition-all">
                {/* LOGO: Altura exacta 52px */}
                <div onClick={() => setView('LANDING')} className="cursor-pointer flex items-center h-full">
                    <img src={LOGO_URL} alt="AuxiliarPro" className="h-[40px] md:h-[52px] w-auto object-contain hover:opacity-90 transition-opacity" />
                </div>

                {/* MENÚ DERECHA: Estilo profesional */}
                <nav className="hidden md:flex items-center gap-2">
                    <button onClick={() => setView('DASHBOARD')} className="text-[14px] font-medium text-slate-600 hover:text-aux-green py-[10px] px-[14px] transition-colors">Estudio</button>
                    <button onClick={() => setView('DERMOCHECK')} className="text-[14px] font-medium text-aux-green border border-aux-green bg-white rounded-full py-[8px] px-[18px] hover:bg-emerald-50 transition-all mx-2">DermoCheck</button>
                    <button onClick={() => setView('BLOG')} className="text-[14px] font-medium text-slate-600 hover:text-aux-green py-[10px] px-[14px] transition-colors">Blog</button>
                    
                    {/* Botón Acción */}
                    {user.isAuthenticated ? 
                        <button onClick={() => setView('DASHBOARD')} className="ml-4 bg-aux-dark text-white text-[14px] font-bold py-[10px] px-[24px] rounded-lg shadow-md hover:bg-slate-800 transition-all transform active:scale-95">Panel</button> :
                        <button onClick={() => setActiveModal('auth')} className="ml-4 bg-aux-dark text-white text-[14px] font-bold py-[10px] px-[24px] rounded-lg shadow-md hover:bg-slate-800 transition-all transform active:scale-95">Ingresar</button>
                    }
                </nav>
                <button className="md:hidden text-aux-dark text-2xl" onClick={()=>alert('Menú móvil')}><Icon name="list" /></button>
            </header>
        );

        // --- APP PRINCIPAL ---
        function App() {
            const [view, setView] = useState('LANDING');
            const [user, setUser] = useState({ name: '', isAuthenticated: false, completedLevels: [] });
            const [quizState, setQuizState] = useState({ active: false, levelId: null, qIndex: 0, score: 0 });
            const [activeModal, setActiveModal] = useState(null);
            const [authMode, setAuthMode] = useState('login'); 
            const [legalTab, setLegalTab] = useState('terms');

            // Carga inicial (Simulada para estabilidad)
            useEffect(() => {
                const local = JSON.parse(localStorage.getItem(LOCAL_STORAGE_KEY) || '{}');
                if (local.isAuthenticated) setUser(local);
            }, []);

            // Login Simulado (Para evitar errores de módulo ahora mismo)
            const handleLogin = (e) => {
                e.preventDefault();
                // Aquí simulamos que el login fue exitoso
                const newUser = { name: 'Colega', isAuthenticated: true, completedLevels: [] };
                setUser(newUser);
                localStorage.setItem(LOCAL_STORAGE_KEY, JSON.stringify(newUser));
                setActiveModal(null);
                setView('DASHBOARD');
            };

            const logout = () => {
                setUser({ name: '', isAuthenticated: false, completedLevels: [] });
                localStorage.removeItem(LOCAL_STORAGE_KEY);
                setView('LANDING');
            };

            // VISTA LANDING
            const renderLanding = () => (
                <div className="flex-1 flex flex-col bg-white w-full h-full overflow-hidden">
                    <Header setView={setView} user={user} setActiveModal={setActiveModal} />
                    <div className="flex-1 overflow-y-auto">
                        <div className="p-6 text-center max-w-md mx-auto mt-8">
                            <div className="inline-block bg-emerald-50 text-aux-green px-3 py-1 rounded-full text-[10px] font-bold mb-6">META: CREDENCIAL 2026</div>
                            <h1 className="text-4xl font-extrabold text-aux-dark mb-6 leading-tight">PREPÁRATE PARA TU <br/><span className="text-aux-green">EXAMEN DE AUXILIAR</span></h1>
                            
                            <div className="flex flex-col gap-3 mb-12">
                                <Button variant="primary" onClick={() => user.isAuthenticated ? setView('DASHBOARD') : setActiveModal('auth')}>COMENZAR AHORA</Button>
                                <Button variant="secondary" onClick={() => setView('BLOG')}>LEER ARTÍCULOS</Button>
                                <Button variant="green" onClick={() => setView('DERMOCHECK')}><Icon name="calculator"/> DERMOCHECK</Button>
                            </div>

                            <div className="watermark-container p-8 mx-4 mb-12 rounded-3xl text-left">
                                <span className="watermark-icon -top-8 -right-4 text-[12rem] rotate-12">!</span>
                                <h3 className="font-bold text-xl text-aux-dark mb-3 flex items-center gap-3 relative z-10"><Icon name="student" className="text-aux-green text-2xl"/> Quién soy</h3>
                                <p className="text-slate-600 font-medium leading-relaxed relative z-10">"Auxiliar en preparación, esta web es mi cuaderno de estudio. Aquí encontrarás lo que estoy aprendiendo para el examen de 2026. ¡Vamos por ese logro juntos!"</p>
                            </div>

                            <div className="border-t border-slate-100 pt-8 mt-4">
                                <h3 className="font-bold text-slate-800 mb-4">¿Dudas sobre el proceso?</h3>
                                <Button variant="secondary" onClick={() => setView('FAQS')}><Icon name="question"/> Ver Preguntas Frecuentes</Button>
                            </div>
                        </div>
                        <Footer />
                    </div>
                </div>
            );

            // VISTA DASHBOARD
            const renderDashboard = () => (
                <div className="flex-1 flex flex-col bg-slate-50 w-full h-full overflow-hidden">
                    <Header setView={setView} user={user} setActiveModal={setActiveModal} />
                    <div className="flex-1 overflow-y-auto p-4 pb-20">
                        <div className="max-w-md mx-auto space-y-4">
                            <div className="bg-aux-dark text-white p-6 rounded-2xl shadow-lg relative overflow-hidden">
                                <div className="flex justify-between items-center mb-2">
                                    <span className="text-xs font-bold text-slate-400 uppercase">Tu Progreso</span>
                                    <span className="text-2xl font-bold text-aux-green">0%</span>
                                </div>
                                <div className="w-full bg-slate-700 h-2 rounded-full"><div className="bg-aux-green h-full rounded-full" style={{width: '0%'}}></div></div>
                            </div>
                            <div className="space-y-3">
                                {LEVELS.map(l => (
                                    <div key={l.id} className="bg-white p-4 rounded-xl border-2 border-slate-100 flex items-center gap-4 hover:border-aux-green cursor-pointer" onClick={()=>alert('Próximamente')}>
                                        <div className={`w-12 h-12 rounded-full flex items-center justify-center text-white ${l.iconBg}`}><Icon name="play"/></div>
                                        <div className="flex-1"><h4 className="font-bold text-aux-dark">{l.title}</h4><p className="text-xs text-slate-500">{l.desc}</p></div>
                                    </div>
                                ))}
                            </div>
                            <div className="grid grid-cols-2 gap-3 mt-4">
                                <Button variant="secondary" onClick={() => setView('LIBRARY')}><Icon name="book"/> Biblioteca</Button>
                                <Button variant="secondary" onClick={() => setActiveModal('community')}><Icon name="users"/> Foro</Button>
                            </div>
                            <div className="pt-6"><Button variant="danger" fullWidth onClick={logout}>Cerrar Sesión</Button></div>
                        </div>
                    </div>
                </div>
            );

            // OTRAS VISTAS SIMPLIFICADAS
            const renderDermoCheck = () => (
                <div className="flex-1 flex flex-col bg-aux-dark w-full h-full absolute inset-0 z-50">
                    <div className="bg-aux-dark text-white p-3 flex justify-between items-center shadow-md z-10">
                        <span className="font-bold flex items-center gap-2"><Icon name="calculator" className="text-aux-green"/> DermoCheck</span>
                        <button onClick={() => setView('LANDING')} className="text-xs bg-white/10 px-3 py-1 rounded-full">Salir</button>
                    </div>
                    <div className="flex-1 bg-black relative"><iframe src={DERMO_URL} className="w-full h-full border-0"></iframe></div>
                </div>
            );

            const Footer = () => (
                <footer className="bg-aux-dark text-slate-400 py-10 px-6 text-center text-xs mt-auto">
                    <div className="max-w-md mx-auto">
                        <div className="border border-slate-700 bg-slate-800/50 p-6 rounded-xl mb-8">
                            <h4 className="font-bold text-white uppercase mb-2">Comentarios</h4>
                            <p className="mb-4">¿Errores o sugerencias?</p>
                            <a href="mailto:auxiliarprofarma@gmail.com" className="bg-white text-aux-dark px-4 py-2 rounded-full font-bold">auxiliarprofarma@gmail.com</a>
                            <p className="mt-4 italic opacity-50">Sitio construido con asistencia de IA. Validar información.</p>
                        </div>
                        <p>© 2026 AuxiliarPro</p>
                    </div>
                </footer>
            );

            const AuthModal = () => {
                if (activeModal !== 'auth') return null;
                return (
                    <div className="fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4">
                        <div className="bg-white p-8 rounded-3xl w-full max-w-sm relative">
                            <button onClick={()=>setActiveModal(null)} className="absolute top-4 right-4 text-slate-400"><Icon name="x"/></button>
                            <h2 className="text-2xl font-bold text-center mb-6 text-aux-dark">Bienvenido</h2>
                            <form onSubmit={handleLogin} className="space-y-4">
                                <input type="email" placeholder="Correo" className="w-full p-3 border rounded-xl" required />
                                <input type="password" placeholder="Contraseña" className="w-full p-3 border rounded-xl" required />
                                <Button fullWidth type="submit">Ingresar (Simulado)</Button>
                            </form>
                        </div>
                    </div>
                );
            };

            // Ruteo
            return (
                <div className="w-full max-w-md bg-white h-screen md:h-[90vh] md:rounded-3xl md:shadow-2xl overflow-hidden flex flex-col relative mx-auto">
                    {view === 'LANDING' && renderLanding()}
                    {view === 'DASHBOARD' && renderDashboard()}
                    {view === 'DERMOCHECK' && renderDermoCheck()}
                    {view === 'BLOG' && <div className="flex-1 flex flex-col"><Header setView={setView} user={user} setActiveModal={setActiveModal}/><div className="p-6"><h2 className="font-bold text-xl">Blog</h2>{BLOG_POSTS.map(p=><div key={p.id} className="border p-4 my-2"><h3>{p.title}</h3></div>)}</div></div>}
                    {view === 'FAQS' && <div className="flex-1 flex flex-col"><Header setView={setView} user={user} setActiveModal={setActiveModal}/><div className="p-6 overflow-y-auto"><h2 className="font-bold text-xl mb-4">Preguntas</h2>{FAQS.map((f,i)=><Accordion key={i} title={f.q} content={f.a}/>)}</div></div>}
                    
                    <AuthModal />
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
