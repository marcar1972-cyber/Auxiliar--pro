<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <meta name="description" content="Plataforma de estudio colaborativa para el examen de Auxiliar de Farmacia en Chile. Preparaci칩n para la credencial sanitaria 2026.">
    <title>Auxiliar Pro | Camino a la Credencial 2026</title>

    <!-- GOOGLE ADSENSE -->
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5783669972264868" crossorigin="anonymous"></script>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
      tailwind.config = {
        theme: {
          extend: {
            colors: {
              'farmacia-green': '#00C853',
              'farmacia-dark': '#0d1b2a',
              'metal-bronze': '#CD7F32',
              'metal-silver': '#C0C0C0',
              'metal-gold': '#FFD700',
              'metal-platinum': '#E5E4E2',
            },
            fontFamily: {
              sans: ['Inter', 'sans-serif'],
              heading: ['Roboto', 'sans-serif']
            },
            animation: {
                'fade-in': 'fadeIn 0.3s ease-out forwards',
                'slide-up': 'slideUp 0.3s ease-out forwards',
                'shine': 'shine 2.5s infinite linear',
            },
            keyframes: {
                fadeIn: { '0%': { opacity: '0' }, '100%': { opacity: '1' } },
                slideUp: { '0%': { opacity: '0', transform: 'translateY(20px)' }, '100%': { opacity: '1', transform: 'translateY(0)' } },
                shine: {
                    '0%': { transform: 'translateX(-150%) skewX(-15deg)' },
                    '40%': { transform: 'translateX(150%) skewX(-15deg)' },
                    '100%': { transform: 'translateX(150%) skewX(-15deg)' }
                }
            }
          }
        }
      }
    </script>
    
    <!-- Fuentes y Efectos -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    
    <!-- React y Babel -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <!-- Iconos -->
    <script src="https://unpkg.com/@phosphor-icons/web"></script>

    <style>
      body { -webkit-tap-highlight-color: transparent; }
      .no-scrollbar::-webkit-scrollbar { display: none; }
      .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
      
      .shiny-effect { position: relative; overflow: hidden; }
      .shiny-effect::after {
          content: ""; position: absolute; top: 0; left: 0; width: 100%; height: 100%;
          background: linear-gradient(to right, transparent 0%, rgba(255,255,255,0.4) 50%, transparent 100%);
          transform: translateX(-150%) skewX(-15deg);
          animation: shine 3s infinite linear;
      }
      
      /* Estilos para contenido HTML dentro de componentes */
      .html-content a { color: #00C853; text-decoration: none; font-weight: 600; }
      .html-content a:hover { text-decoration: underline; }
      .html-content ul { list-style-type: disc; padding-left: 1.2rem; margin-top: 0.5rem; margin-bottom: 0.5rem; }
      .html-content li { margin-bottom: 0.25rem; }
      .html-content strong { color: #0f172a; font-weight: 700; }
      
      .blog-content h1 { font-size: 1.5rem; font-weight: 800; color: #0d1b2a; margin-bottom: 1rem; line-height: 1.2; }
      .blog-content h2 { font-size: 1.25rem; font-weight: 700; color: #059669; margin-top: 1.5rem; margin-bottom: 0.75rem; }
      .blog-content h3 { font-size: 1.1rem; font-weight: 600; color: #334155; margin-top: 1.25rem; margin-bottom: 0.5rem; }
      .blog-content p { margin-bottom: 1rem; line-height: 1.6; color: #475569; }
      .blog-content ul { list-style-type: disc; padding-left: 1.5rem; margin-bottom: 1rem; color: #475569; }
      .blog-content li { margin-bottom: 0.5rem; }
      .blog-content strong { color: #0f172a; font-weight: 700; }
      .blog-content .cta-box { background-color: #ecfdf5; border: 1px solid #a7f3d0; padding: 1.5rem; border-radius: 0.75rem; margin-top: 2rem; text-align: center; }
    </style>
</head>
<body class="bg-slate-50 text-slate-800 antialiased min-h-screen flex flex-col items-center justify-center font-sans">

    <div id="root" class="w-full h-full flex justify-center items-center"></div>

    <script type="text/babel" data-type="module" data-presets="react">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.13.0/firebase-app.js";
        import { getAuth, signInWithEmailAndPassword, createUserWithEmailAndPassword, signOut, onAuthStateChanged, updateProfile } from "https://www.gstatic.com/firebasejs/10.13.0/firebase-auth.js";
        import { getFirestore, doc, setDoc, onSnapshot } from "https://www.gstatic.com/firebasejs/10.13.0/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyDNhuSBBhmmQSV0BHC8MOtLKgAUpvtfWfE",
            authDomain: "auxiliar-pro.firebaseapp.com",
            projectId: "auxiliar-pro",
            storageBucket: "auxiliar-pro.firebasestorage.app",
            messagingSenderId: "342196612566",
            appId: "1:342196612566:web:c7f34365c4e10502e60877"
        };

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);
        const appId = 'auxiliar-pro';

        const { useState, useEffect } = React;

        const APP_VERSION = "6.7.0 Final Request";
        const LOCAL_STORAGE_KEY = 'auxiliar_pro_data';

        const BLOG_POSTS = [
            { id: 'art1', date: '04 DIC', category: 'Legal', title: 'Decreto 466: La "Biblia" que define tu rol en la Farmacia', excerpt: 'Entender el Reglamento de Farmacias es la diferencia entre aprobar y reprobar. Aqu칤 te explico los art칤culos claves.', content: '<h1>Decreto 466: La "Biblia" que define tu rol en la Farmacia</h1><p>Colega, si hay un documento que debes tener bajo la almohada, es el <strong>Decreto Supremo 466</strong>. No es solo papeleo; es el reglamento que define qu칠 puedes hacer, qu칠 no, y qui칠n manda en la farmacia.</p><h2>1. 쯈ui칠n es el Jefe? (Art. 12 y 14)</h2><p>La normativa es tajante: <strong>La Direcci칩n T칠cnica corresponde exclusivamente al Qu칤mico Farmac칠utico (QF)</strong>. </p><ul><li>El QF debe estar <strong>siempre presente</strong> durante el horario de funcionamiento.</li><li>Si el QF no est치, la farmacia <strong>no puede funcionar</strong>.</li><li>T칰, como auxiliar, eres su brazo derecho, pero legalmente act칰as bajo su supervisi칩n directa.</li></ul><h2>2. Condiciones Ambientales (Art. 28)</h2><p>No es solo por comodidad. Los medicamentos se degradan.</p><ul><li><strong>Temperatura ambiente:</strong> M치ximo 25춿C.</li><li><strong>Cadena de Fr칤o:</strong> Estrictamente entre <strong>2춿C y 8춿C</strong>.</li></ul><div class="cta-box"><h3 class="text-farmacia-green">쯊e sientes seguro con la legislaci칩n?</h3><p>Pon a prueba lo que acabas de leer en el <strong>Nivel 2: Intermedio</strong> del simulador.</p></div>' },
            { id: 'art2', date: '02 DIC', category: 'T칠cnico', title: 'Ley de F치rmacos (Ley 20.724): Cambios que impactan tu trabajo', excerpt: 'Bioequivalencia, venta directa y fraccionamiento. Descubre c칩mo esta ley cambi칩 la forma en que dispensamos.', content: '<h1>Ley de F치rmacos (Ley 20.724)</h1><p>Seguramente has escuchado hablar de la "Ley de F치rmacos". Para nosotros, los auxiliares, esta ley cambi칩 las reglas del juego.</p><h2>1. La Bioequivalencia es Ley</h2><p>Antes era opcional, hoy es obligaci칩n. La ley exige que la farmacia tenga disponibles los <strong>medicamentos bioequivalentes</strong> (los de la franja amarilla).</p><p><strong>Tu deber:</strong> Debes informar al paciente que existe una alternativa bioequivalente si la receta lo permite.</p><h2>2. Medicamentos de Venta Directa (OTC) en G칩ndolas</h2><p>La ley permiti칩 que ciertos medicamentos que no requieren receta puedan estar al alcance del p칰blico en estanter칤as.</p><p><strong>Ojo:</strong> Aunque est칠n en g칩ndola, la venta final siempre pasa por caja y debe haber asesor칤a disponible.</p><div class="cta-box"><h3 class="text-farmacia-green">춰A practicar!</h3><p>Revisa las preguntas sobre Bioequivalencia en la <strong>Prueba de Conocimientos B치sicos</strong>.</p></div>' }
        ];

        const sourceLink = `<br/><a href='https://seremienlinea.minsal.cl' target='_blank' class='text-xs text-farmacia-green font-bold hover:underline mt-2 inline-block'>游댕 Revisar fuente oficial</a>`;
        
        const FAQS = [
            { q: "Descripci칩n del Tr치mite", a: "La certificaci칩n de competencias de Auxiliar de Farmacia consiste en la presentaci칩n de una solicitud ante la Secretar칤a Regional Ministerial de Salud, para someterse a una evaluaci칩n que permite verificar formalmente los conocimientos y capacidades de una persona para desempe침arse como Auxiliar de Farmacia bajo la supervisi칩n de un Qu칤mico Farmac칠utico. Este tr치mite podr칤a requerir de una fiscalizaci칩n o etapa presencial." + sourceLink },
            { q: "쮻칩nde y c칩mo hago el tr치mite?", a: "El tr치mite se encuentra disponible en l칤nea ingresando con Clave 칔nica en el bot칩n 'Ir al tr치mite' del portal SEREMI en L칤nea." + sourceLink },
            { q: "쮸 qui칠n va dirigido?", a: "Personas naturales que deseen optar a la certificaci칩n de competecias de Auxiliar de Farmacia y que cumplan los requisitos establecidos en la normativa vigente." + sourceLink },
            { q: "쯈u칠 necesito para hacer el tr치mite?", a: "Para hacer el tr치mite, se solicitan los siguientes documentos:<ul><li>Certificado de ense침anza media.</li><li>Copia del contrato de trabajo o Certificado del empleador que acredite antig칲edad laboral.</li><li>Certificado de desempe침o laboral emitido por el Qu칤mico Farmac칠utico que acredite a lo menos 1 a침o de desempe침o efectivo (Se incorpora certificado tipo descargable).</li><li>Foto tipo carnet.</li></ul>" + sourceLink },
            { q: "쮺u치l es el costo del tr치mite?", a: "El tr치mite tiene un costo diferenciado seg칰n el tipo de solicitud:<ul><li>Derecho a Examen $19.100</li><li>Inscripci칩n en el Registro (incluye primer certificado) $47.600</li><li>Diploma o Carnet $29.700</li><li>Certificado (adicional) $29.700</li><li>Validaci칩n de documentos (t칤tulos o certificados) $19.100</li></ul>" + sourceLink },
            { q: "Marco Legal", a: "Decreto Supremo N췈 466 de 1984." + sourceLink }
        ];

        // --- BANCO DE PREGUNTAS ---
        const LEVELS = [
            {
                id: 1, title: 'Prueba de Conocimientos B치sicos', desc: 'Fundamentos esenciales.', medal: 'Bronce', iconBg: 'bg-gradient-to-br from-[#cd7f32] to-[#8B4513]', borderColor: 'border-[#cd7f32]/50', textColor: 'text-[#8B4513]', qCount: 10, passingScore: 6, examLabel: 'DIAGN칍STICO INICIAL', 
                topics: ['Conceptos B치sicos', 'Rol del Auxiliar'],
                questions: [ 
                    { id: 101, topic: 'Rol del Auxiliar', text: '쯈ui칠n es el responsable t칠cnico legal de la farmacia?', options: ['Due침o', 'Auxiliar', 'Qu칤mico Farmac칠utico', 'Gerente'], correctIndex: 2, explanation: 'El QF es el 칰nico responsable legal ante la autoridad sanitaria.' },
                    { id: 102, topic: 'Almacenamiento', text: 'Rango de temperatura para cadena de fr칤o:', options: ['0-5춿C', '2-8춿C', '8-15춿C', 'Ambiente'], correctIndex: 1, explanation: 'El rango estricto es entre 2춿C y 8춿C.' },
                    { id: 103, topic: 'V칤as de Administraci칩n', text: 'V칤a de administraci칩n sublingual:', options: ['Debajo de la lengua', 'Sobre la lengua', 'Tragada', 'Masticada'], correctIndex: 0, explanation: 'Permite absorci칩n r치pida evitando el primer paso hep치tico.' },
                    { id: 104, topic: 'Terminolog칤a', text: '쯈u칠 significa OTC?', options: ['Receta Retenida', 'Venta Directa', 'Uso Hospitalario', 'Controlado'], correctIndex: 1, explanation: 'Over The Counter: Medicamentos que no requieren receta m칠dica.' },
                    { id: 105, topic: 'Rol del Auxiliar', text: 'Funci칩n principal del Auxiliar:', options: ['Diagnosticar', 'Recetar', 'Dispensar e informar', 'Administrar local'], correctIndex: 2, explanation: 'Colaborar con el QF en la dispensaci칩n informada.' },
                    { id: 106, topic: 'Bioequivalencia', text: 'Identificaci칩n visual de Bioequivalentes:', options: ['Franja Amarilla', 'Estrella Verde', 'Caja Roja', 'Ninguna'], correctIndex: 0, explanation: 'La franja amarilla es el distintivo legal en Chile.' },
                    { id: 107, topic: 'Conceptos B치sicos', text: '쯈u칠 es un Placebo?', options: ['Sustancia inerte', 'Principio activo potente', 'Marca comercial', 'Gen칠rico'], correctIndex: 0, explanation: 'Sustancia sin acci칩n farmacol칩gica usada por efecto psicol칩gico.' },
                    { id: 108, topic: 'V칤as de Administraci칩n', text: 'Ejemplo de v칤a Parenteral:', options: ['Jarabes', 'Inyectables', 'Cremas', 'Supositorios'], correctIndex: 1, explanation: 'V칤as que atraviesan la piel (IV, IM, SC).' },
                    { id: 109, topic: 'Almacenamiento', text: 'La fecha de vencimiento indica:', options: ['Fecha de fabricaci칩n', 'L칤mite de eficacia/seguridad', 'Fecha de venta', 'Fecha de apertura'], correctIndex: 1, explanation: 'Hasta esa fecha el laboratorio garantiza la estabilidad.' },
                    { id: 110, topic: 'Legislaci칩n', text: '쯈u칠 receta usan los estupefacientes?', options: ['Simple', 'Retenida', 'Cheque', 'Magistral'], correctIndex: 2, explanation: 'Receta Cheque es obligatoria para estupefacientes y psicotr칩picos lista II.' }
                ]
            },
            {
                id: 2, title: 'Nivel 2: Intermedio', desc: 'Legislaci칩n y almacenamiento.', medal: 'Plata', iconBg: 'bg-gradient-to-br from-[#E0E0E0] to-[#9E9E9E]', borderColor: 'border-[#9E9E9E]/50', textColor: 'text-[#757575]', qCount: 15, passingScore: 9, examLabel: 'SIMULACRO NIVEL 2',
                topics: ['Legislaci칩n', 'Reglamentos'],
                questions: [
                    { id: 201, topic: 'Decretos', text: '쮻ecreto que aprueba el Reglamento de Farmacias?', options: ['DS 594', 'DS 466', 'DS 404', 'DS 405'], correctIndex: 1, explanation: 'DS 466 es el reglamento base.' },
                    { id: 202, topic: 'Recetas', text: 'Validez de una Receta Cheque:', options: ['60 d칤as', '30 d칤as', '10 d칤as', 'Indefinida'], correctIndex: 1, explanation: '30 d칤as corridos desde su emisi칩n.' },
                    { id: 203, topic: 'Controlados', text: '쯈u칠 indica la estrella verde en el envase?', options: ['Bioequivalente', 'Psicotr칩pico Lista III', 'Estupefaciente', 'Psicotr칩pico Lista IV'], correctIndex: 2, explanation: 'Estupefacientes (o psicotr칩picos L-I) sujetos a control legal.' },
                    { id: 204, topic: 'Libros Oficiales', text: '쮻칩nde se registran los reclamos?', options: ['Cuaderno', 'Sistema PC', 'Libro de Reclamos foliado', 'Buz칩n'], correctIndex: 2, explanation: 'Libro foliado y timbrado por la Seremi.' },
                    { id: 205, topic: 'Almacenamiento', text: 'Temperatura m치xima ambiental en farmacia:', options: ['20춿C', '25춿C', '30춿C', '15춿C'], correctIndex: 1, explanation: 'Generalmente 25춿C para asegurar estabilidad.' },
                    { id: 206, topic: 'Decretos', text: 'El Decreto 404 regula:', options: ['Farmacias', 'Estupefacientes', 'Psicotr칩picos', 'Cosm칠ticos'], correctIndex: 1, explanation: 'Reglamento de Estupefacientes.' },
                    { id: 207, topic: 'Decretos', text: 'El Decreto 405 regula:', options: ['Farmacias', 'Estupefacientes', 'Psicotr칩picos', 'Alimentos'], correctIndex: 2, explanation: 'Reglamento de Psicotr칩picos.' },
                    { id: 208, topic: 'Autoridad Sanitaria', text: '쯈ui칠n autoriza la instalaci칩n de una farmacia?', options: ['Municipalidad', 'ISP', 'SEREMI de Salud', 'SII'], correctIndex: 2, explanation: 'La Autoridad Sanitaria Regional (SEREMI).' },
                    { id: 209, topic: 'Dispensaci칩n', text: '쯇uede un auxiliar sustituir un medicamento?', options: ['S칤, siempre', 'Solo por Bioequivalentes', 'Nunca', 'Si es m치s barato'], correctIndex: 1, explanation: 'Solo si es Bioequivalente certificado.' },
                    { id: 210, topic: 'Almacenamiento', text: 'Medicamentos termol치biles requieren:', options: ['Luz directa', 'Cadena de Fr칤o', 'Congelaci칩n', 'Calor'], correctIndex: 1, explanation: 'Termol치bil = sensible a la temperatura.' },
                    { id: 211, topic: 'Recetas', text: 'La Receta Retenida se archiva por:', options: ['No se archiva', '1 a침o', '6 meses', '2 a침os'], correctIndex: 0, explanation: 'Se debe foliar y archivar cronol칩gicamente.' }, 
                    { id: 212, topic: 'Dispensaci칩n', text: 'Venta de Corticoides Sist칠micos requiere:', options: ['Venta Directa', 'Receta Simple', 'Receta Retenida', 'Receta Cheque'], correctIndex: 1, explanation: 'Generalmente receta simple, salvo excepciones.' },
                    { id: 213, topic: 'Libros Oficiales', text: 'Libro de control de Psicotr칩picos debe ser llenado por:', options: ['Auxiliar', 'Cajero', 'Qu칤mico Farmac칠utico', 'Bodeguero'], correctIndex: 2, explanation: 'Responsabilidad exclusiva del QF.' },
                    { id: 214, topic: 'Almacenamiento', text: '쯈u칠 es FEFO?', options: ['Primero en entrar, primero en salir', 'Primero en vencer, primero en salir', 'Farmacia Eficiente', 'Fecha Final'], correctIndex: 1, explanation: 'First Expire, First Out.' },
                    { id: 215, topic: 'Legislaci칩n', text: '쯈ui칠n fiscaliza las farmacias?', options: ['Carabineros', 'SERNAC', 'ISP y SEREMI', 'Municipalidad'], correctIndex: 2, explanation: 'El ISP y las SEREMIS de salud.' }
                ] 
            },
            {
                id: 3, title: 'Nivel 3: Avanzado', desc: 'Atenci칩n y dispensaci칩n.', medal: 'Oro', iconBg: 'bg-gradient-to-br from-[#FFD700] to-[#B8860B]', borderColor: 'border-[#FFD700]/50', textColor: 'text-[#B8860B]', qCount: 25, passingScore: 18, examLabel: 'SIMULACRO NIVEL 3',
                topics: ['Dispensaci칩n', 'Bioequivalencia'],
                questions: [
                    { id: 301, topic: 'Dispensaci칩n', text: 'Al dispensar un antibi칩tico, 쯤u칠 es lo m치s importante?', options: ['Cobrar primero', 'Verificar receta y fecha', 'Ofrecer vitaminas', 'Ver la marca'], correctIndex: 1, explanation: 'Es obligatorio verificar receta y vigencia.' },
                    { id: 302, topic: 'Bioequivalencia', text: 'La franja amarilla en un envase indica:', options: ['Venta Directa', 'Bioequivalencia', 'Uso hospitalario', 'Producto natural'], correctIndex: 1, explanation: 'Medicamento Bioequivalente.' },
                    { id: 303, topic: 'Terminolog칤a', text: '쯈u칠 significa DCI?', options: ['Denominaci칩n Com칰n Internacional', 'Dosis Com칰n Inyectable', 'Departamento Cl칤nico Interno', 'Dosis Controlada Individual'], correctIndex: 0, explanation: 'Nombre gen칠rico universal del principio activo.' },
                    { id: 304, topic: 'Formas Farmac칠uticas', text: 'Un medicamento "Forte" generalmente implica:', options: ['Mayor tama침o', 'Mayor dosis del principio activo', 'Mejor sabor', 'M치s barato'], correctIndex: 1, explanation: 'Mayor concentraci칩n.' },
                    { id: 305, topic: 'Atenci칩n', text: 'Si un paciente pide consejo m칠dico:', options: ['Le recetamos algo suave', 'Lo derivamos al QF o m칠dico', 'Le damos lo que pide', 'Buscamos en Google'], correctIndex: 1, explanation: 'El auxiliar no diagnostica.' },
                    { id: 306, topic: 'Dispensaci칩n', text: 'Venta de Amoxicilina requiere:', options: ['Receta M칠dica', 'Venta Directa', 'Receta Cheque', 'Ninguna'], correctIndex: 0, explanation: 'Antibi칩ticos requieren receta.' },
                    { id: 307, topic: 'Bioequivalencia', text: '쮼l bioequivalente tiene el mismo efecto terap칠utico?', options: ['No, es peor', 'S칤, comprobado cient칤ficamente', 'Depende de la marca', 'Solo si es caro'], correctIndex: 1, explanation: 'Esa es la definici칩n de bioequivalencia.' },
                    { id: 308, topic: 'Formas Farmac칠uticas', text: 'Jarabe es una forma:', options: ['S칩lida', 'Semis칩lida', 'L칤quida', 'Gaseosa'], correctIndex: 2, explanation: 'L칤quida azucarada.' },
                    { id: 309, topic: 'Atenci칩n', text: 'Paciente embarazada pide medicamento para dolor:', options: ['Vender Ibuprofeno', 'Vender Paracetamol', 'Consultar al QF', 'Vender Vitaminas'], correctIndex: 2, explanation: 'Poblaci칩n de riesgo, siempre consultar al QF.' },
                    { id: 310, topic: 'Almacenamiento', text: 'Fotosensibilidad significa:', options: ['Proteger de la humedad', 'Proteger de la luz', 'Refrigerar', 'Agitar'], correctIndex: 1, explanation: 'Sensible a la luz.' },
                    { id: 311, topic: 'Dispensaci칩n', text: 'Dosis m치xima de Paracetamol diario adulto:', options: ['1g', '4g', '8g', '2g'], correctIndex: 1, explanation: '4 gramos al d칤a m치ximo para evitar da침o hep치tico.' },
                    { id: 312, topic: 'Terminolog칤a', text: 'Posolog칤a significa:', options: ['Estudio de los venenos', 'Dosis y frecuencia de toma', 'Forma del medicamento', 'Precio'], correctIndex: 1, explanation: 'C칩mo se debe tomar el medicamento.' },
                    { id: 313, topic: 'Formas Farmac칠uticas', text: 'Supositorio es v칤a:', options: ['Oral', 'Rectal', 'Vaginal', 'T칩pica'], correctIndex: 1, explanation: 'V칤a rectal.' },
                    { id: 314, topic: 'Legislaci칩n', text: 'Receta de Psicotr칩picos se retiene:', options: ['Siempre', 'Nunca', 'A veces', 'Solo si el paciente quiere'], correctIndex: 0, explanation: 'Se debe retener para control.' },
                    { id: 315, topic: 'Atenci칩n', text: 'Cliente reclama por medicamento vencido:', options: ['No hacer nada', 'Llamar al QF', 'Devolver el dinero', 'Cambiarlo sin avisar'], correctIndex: 1, explanation: 'El QF debe manejar la desviaci칩n de calidad.' },
                    { id: 316, topic: 'Bioequivalencia', text: '쯃os gen칠ricos son bioequivalentes?', options: ['Todos s칤', 'Ninguno', 'Solo los que tienen franja amarilla', 'Solo los de marca'], correctIndex: 2, explanation: 'Solo si tienen la certificaci칩n (franja).' },
                    { id: 317, topic: 'Dispensaci칩n', text: 'Receta retenida sin fecha:', options: ['Se despacha igual', 'Se pone la fecha de hoy', 'No se despacha', 'Se llama al m칠dico'], correctIndex: 2, explanation: 'Receta incompleta no es v치lida.' },
                    { id: 318, topic: 'Formas Farmac칠uticas', text: 'Comprimido recubierto sirve para:', options: ['Mejor sabor', 'Proteger el est칩mago', 'Verse bonito', 'Ser m치s caro'], correctIndex: 1, explanation: 'Protecci칩n g치strica o del f치rmaco.' },
                    { id: 319, topic: 'Atenci칩n', text: 'Paciente diab칠tico pide jarabe para la tos:', options: ['Vender cualquiera', 'Vender uno sin az칰car', 'Vender pastillas', 'Vender miel'], correctIndex: 1, explanation: 'Evitar az칰car en diab칠ticos.' },
                    { id: 320, topic: 'Almacenamiento', text: 'Medicamentos LASA son:', options: ['Los m치s caros', 'Los que suenan o se ven igual', 'Los vencidos', 'Los de venta libre'], correctIndex: 1, explanation: 'Look Alike, Sound Alike (riesgo de error).' },
                    { id: 321, topic: 'Dispensaci칩n', text: '쯉e puede fraccionar un medicamento?', options: ['Nunca', 'Si la farmacia est치 autorizada', 'Si el cliente quiere', 'Solo antibi칩ticos'], correctIndex: 1, explanation: 'Requiere autorizaci칩n y zona de fraccionamiento.' },
                    { id: 322, topic: 'Terminolog칤a', text: 'Excipiente es:', options: ['El principio activo', 'Sustancia inactiva que da forma', 'El envase', 'La marca'], correctIndex: 1, explanation: 'Veh칤culo o aditivo.' },
                    { id: 323, topic: 'Legislaci칩n', text: 'Venta de Sildenafil requiere:', options: ['Receta M칠dica', 'Venta Directa', 'Receta Cheque', 'Carnet'], correctIndex: 0, explanation: 'Condici칩n de venta bajo receta.' },
                    { id: 324, topic: 'Atenci칩n', text: 'Uso racional de medicamentos promueve:', options: ['Vender m치s', 'Usar el medicamento adecuado al menor costo posible', 'No tomar remedios', 'Usar solo naturales'], correctIndex: 1, explanation: 'Definici칩n de la OMS.' },
                    { id: 325, topic: 'Bioequivalencia', text: 'El estudio de bioequivalencia compara:', options: ['Precios', 'Biodisponibilidad con el referente', 'Colores de caja', 'Tama침o de pastilla'], correctIndex: 1, explanation: 'Comparaci칩n de curvas plasm치ticas.' }
                ] 
            },
            {
                id: 4, title: 'Nivel 4: Final (Simulacro)', desc: 'Posolog칤a y c치lculos.', medal: 'Platino', iconBg: 'bg-gradient-to-br from-[#E5E4E2] to-[#607D8B]', borderColor: 'border-[#607D8B]/50', textColor: 'text-[#455A64]', qCount: 40, passingScore: 28, topics: ['C치lculos', 'Posolog칤a'], examLabel: 'SIMULACRO FINAL',
                questions: [
                    { id: 401, topic: 'C치lculos', text: 'Si la dosis es 500mg y tengo comprimidos de 250mg, 쯖u치ntos dispenso?', options: ['1', '1.5', '2', '3'], correctIndex: 2, explanation: '500/250 = 2 comprimidos.' },
                    { id: 402, topic: 'Posolog칤a', text: '쮺u치ntos ml hay en una cuchara de t칠 (medida est치ndar)?', options: ['2.5 ml', '5 ml', '10 ml', '15 ml'], correctIndex: 1, explanation: '5 ml.' },
                    { id: 403, topic: 'C치lculos', text: 'Si un jarabe trae 120ml y la dosis es 10ml cada 8 horas, 쯖u치nto dura?', options: ['2 d칤as', '3 d칤as', '4 d칤as', '5 d칤as'], correctIndex: 2, explanation: '30ml diarios. 120/30 = 4 d칤as.' },
                    { id: 404, topic: 'Preparados', text: 'Para preparar 100ml de alcohol al 70% a partir de 96%, necesito:', options: ['M치s agua que alcohol', 'Solo alcohol', 'C치lculo de diluci칩n', 'Mezclar partes iguales'], correctIndex: 2, explanation: 'Se usa la f칩rmula de diluci칩n.' },
                    { id: 405, topic: 'Posolog칤a', text: 'Dosis "SOS" significa:', options: ['Solo por la ma침ana', 'En caso de necesidad', 'Sin otro s칤ntoma', 'Siempre o siempre'], correctIndex: 1, explanation: 'Si los s칤ntomas aparecen.' },
                    { id: 406, topic: 'C치lculos', text: 'Receta: 1 comp cada 12 horas por 7 d칤as. 쮺u치ntos comprimidos total?', options: ['7', '10', '14', '21'], correctIndex: 2, explanation: '2 por d칤a x 7 d칤as = 14.' },
                    { id: 407, topic: 'C치lculos', text: 'Dosis: 5ml cada 8 horas. 쯌olumen diario total?', options: ['10 ml', '15 ml', '20 ml', '5 ml'], correctIndex: 1, explanation: '5ml x 3 veces = 15ml.' },
                    { id: 408, topic: 'Posolog칤a', text: '1 comprimido "antes de las comidas" es:', options: ['Postprandial', 'Preprandial', 'Ayunas', 'Con agua'], correctIndex: 1, explanation: 'Preprandial.' },
                    { id: 409, topic: 'C치lculos', text: 'Paciente necesita 1g de antibi칩tico al d칤a. Comprimidos son de 500mg. 쮻osis diaria?', options: ['1 comp', '2 comp', '3 comp', '4 comp'], correctIndex: 3, explanation: '1g = 1000mg. 1000/500 = 2 comp por dosis... espera, 1g al D칈A. Si es dosis 칰nica diaria son 2 comp juntos. Si es repartido depende. Asumiendo dosis total diaria 1g -> 2 comp de 500mg.' },
                    { id: 410, topic: 'Gesti칩n', text: 'Si el stock m칤nimo es 5 y tengo 2, 쯤u칠 hago?', options: ['Vender los 2', 'Pedir reposici칩n', 'Esconderlos', 'Nada'], correctIndex: 1, explanation: 'Solicitar pedido.' },
                    { id: 411, topic: 'C치lculos', text: 'Gotas: 20 gotas equivalen aprox a:', options: ['0.5 ml', '1 ml', '2 ml', '5 ml'], correctIndex: 1, explanation: 'Est치ndar: 20 gotas = 1 ml.' },
                    { id: 412, topic: 'Posolog칤a', text: 'Cada 6 horas significa cu치ntas veces al d칤a:', options: ['3 veces', '4 veces', '6 veces', '2 veces'], correctIndex: 1, explanation: '24 horas / 6 = 4 tomas.' },
                    { id: 413, topic: 'C치lculos', text: 'Caja de 30 comp. Dosis 1 al d칤a. 쮺u치nto dura?', options: ['15 d칤as', '1 mes', '2 meses', '1 semana'], correctIndex: 1, explanation: '30 d칤as.' },
                    { id: 414, topic: 'Posolog칤a', text: 'V칤a 칩tica se aplica en:', options: ['Ojos', 'O칤dos', 'Nariz', 'Boca'], correctIndex: 1, explanation: 'O칤dos.' },
                    { id: 415, topic: 'C치lculos', text: 'Receta pide 60mg. Tengo pastillas de 20mg. 쮺u치ntas doy?', options: ['1', '2', '3', '4'], correctIndex: 2, explanation: '60 / 20 = 3.' },
                    { id: 416, topic: 'Posolog칤a', text: 'Uso t칩pico significa:', options: ['Tragar', 'Inyectar', 'Aplicar sobre piel/mucosa', 'Inhalar'], correctIndex: 2, explanation: 'Externo local.' },
                    { id: 417, topic: 'C치lculos', text: 'Si vendo 10 cajas a $1.000 cada una, total:', options: ['$1.000', '$5.000', '$10.000', '$100.000'], correctIndex: 2, explanation: 'C치lculo simple de caja.' },
                    { id: 418, topic: 'Posolog칤a', text: 'Ayunas significa:', options: ['Con leche', 'Sin alimentos (est칩mago vac칤o)', 'Al acostarse', 'Con almuerzo'], correctIndex: 1, explanation: 'Sin alimentos.' },
                    { id: 419, topic: 'C치lculos', text: 'Dosis 2 puff cada 12 horas. Un inhalador de 200 dosis dura:', options: ['25 d칤as', '50 d칤as', '100 d칤as', '10 d칤as'], correctIndex: 1, explanation: '4 puff diarios. 200/4 = 50 d칤as.' },
                    { id: 420, topic: 'Gesti칩n', text: 'Diferencia de inventario:', options: ['Lo que sobra', 'Lo que falta', 'Diferencia entre sistema y f칤sico', 'Ventas del d칤a'], correctIndex: 2, explanation: 'Discrepancia de stock.' },
                    { id: 421, topic: 'C치lculos', text: 'Receta: "Ibuprofeno 400mg, 1 comprimido cada 8 horas por 5 d칤as". 쮺u치ntos comprimidos en total?', options: ['10', '15', '20', '25'], correctIndex: 1, explanation: '3 tomas diarias x 5 d칤as = 15 comprimidos.' },
                    { id: 422, topic: 'Posolog칤a', text: 'Una soluci칩n tiene una concentraci칩n de 2 mg/ml. Si el paciente necesita 10 mg, 쯖u치ntos ml debe tomar?', options: ['2 ml', '5 ml', '10 ml', '20 ml'], correctIndex: 1, explanation: '10 mg / (2 mg/ml) = 5 ml.' },
                    { id: 423, topic: 'C치lculos', text: 'Paciente de 20 kg necesita 15 mg/kg/d칤a de Amoxicilina repartido en 3 tomas. La suspensi칩n es de 250mg/5ml. 쮺u치ntos ml por toma?', options: ['2 ml', '5 ml', '10 ml', '15 ml'], correctIndex: 0, explanation: 'Dosis diaria total: 20kg * 15mg/kg = 300mg. Por toma: 300mg / 3 = 100mg. Regla de tres: si 250mg son 5ml, 100mg son X. X = (100*5)/250 = 2ml.' },
                    { id: 424, topic: 'Posolog칤a', text: 'Dosis de "1 cucharada sopera" equivale a:', options: ['5 ml', '10 ml', '15 ml', '20 ml'], correctIndex: 2, explanation: 'Est치ndar: 1 cucharada sopera = 15 ml.' },
                    { id: 425, topic: 'C치lculos', text: 'Un frasco de 60ml de jarabe debe durar 5 d칤as. 쮺u치l es la dosis diaria?', options: ['10 ml', '12 ml', '15 ml', '20 ml'], correctIndex: 1, explanation: '60 ml / 5 d칤as = 12 ml/d칤a.' },
                    { id: 426, topic: 'Posolog칤a', text: 'Cada 4 horas significa:', options: ['4 veces al d칤a', '5 veces al d칤a', '6 veces al d칤a', '8 veces al d칤a'], correctIndex: 2, explanation: '24 horas / 4 = 6 tomas diarias.' },
                    { id: 427, topic: 'C치lculos', text: 'Si la dosis es 75mg y tengo comprimidos de 50mg que se pueden fraccionar, 쯖u치ntos dispenso?', options: ['1', '1.5', '2', '2.5'], correctIndex: 1, explanation: '75mg / 50mg = 1.5 comprimidos.' },
                    { id: 428, topic: 'Posolog칤a', text: 'Inyecci칩n Intramuscular (IM) se aplica en:', options: ['Vena', 'M칰sculo', 'Piel', 'Grasa'], correctIndex: 1, explanation: 'Directo al tejido muscular.' },
                    { id: 429, topic: 'C치lculos', text: 'Receta: 2 comprimidos juntos al acostarse por 10 d칤as. Total:', options: ['10', '20', '30', '40'], correctIndex: 1, explanation: '2 comp/d칤a x 10 d칤as = 20 comprimidos.' },
                    { id: 430, topic: 'Gesti칩n', text: 'El porcentaje de margen de ganancia se calcula sobre:', options: ['El costo', 'El precio de venta', 'El impuesto', 'La receta'], correctIndex: 1, explanation: 'Com칰nmente el margen se calcula sobre el precio de venta final neto.' },
                    { id: 431, topic: 'C치lculos', text: 'Dosis pedi치trica: 1 gota por kilo de peso por dosis. Ni침o de 15kg, jarabe de 30ml. Cada 8 horas. 쮺u치nto dura el frasco? (1ml = 20 gotas)', options: ['5 d칤as', '10 d칤as', '13 d칤as', '20 d칤as'], correctIndex: 2, explanation: 'Dosis: 15 gotas. 15 gotas / 20 gotas/ml = 0.75 ml por toma. 3 tomas diarias = 2.25 ml/d칤a. 30ml / 2.25 ml/d칤a = 13.33 d칤as. Aprox 13 d칤as.' },
                    { id: 432, topic: 'Posolog칤a', text: 'V칤a Subcut치nea (SC) se aplica en:', options: ['M칰sculo', 'Tejido adiposo', 'Dermis', 'Vena'], correctIndex: 1, explanation: 'Bajo la piel, en la grasa.' },
                    { id: 433, topic: 'C치lculos', text: 'Si un medicamento al 1% tiene 1g en 100ml, 쯖u치ntos mg hay en 5ml?', options: ['5 mg', '10 mg', '50 mg', '100 mg'], correctIndex: 2, explanation: '1% = 1g/100ml = 1000mg/100ml = 10mg/ml. En 5ml hay 5 * 10mg = 50mg.' },
                    { id: 434, topic: 'Posolog칤a', text: 'Uso Oft치lmico se aplica en:', options: ['O칤dos', 'Ojos', 'Nariz', 'Boca'], correctIndex: 1, explanation: 'Gotas o ung칲entos para los ojos.' },
                    { id: 435, topic: 'C치lculos', text: 'Receta: 500mg cada 6 horas por 7 d칤as. Presentaci칩n: 500mg x 20 comprimidos. 쮺u치ntas cajas necesita?', options: ['1', '2', '3', '4'], correctIndex: 1, explanation: 'Dosis diaria: 4 comp. Total: 4 comp/d칤a x 7 d칤as = 28 comprimidos. Necesita 2 cajas de 20.' },
                    { id: 436, topic: 'Posolog칤a', text: 'Comprimido de Liberaci칩n Prolongada:', options: ['Acci칩n r치pida', 'Se puede moler', 'Se absorbe lentamente', 'Dosis doble'], correctIndex: 2, explanation: 'No se debe triturar, libera el f치rmaco de a poco.' },
                    { id: 437, topic: 'C치lculos', text: 'Si vendo $100.000 y mi costo fue $70.000, mi margen bruto es:', options: ['20%', '30%', '40%', '70%'], correctIndex: 1, explanation: 'Margen = (Venta - Costo) / Venta. (100000 - 70000) / 100000 = 30000 / 100000 = 0.3 = 30%.' },
                    { id: 438, topic: 'Posolog칤a', text: 'V칤a T칩pica Nasal se aplica en:', options: ['Ojos', 'O칤dos', 'Nariz', 'Piel'], correctIndex: 2, explanation: 'Fosas nasales.' },
                    { id: 439, topic: 'C치lculos', text: 'Dosis 10ml. Frasco de 200ml. Precio $5.000. Costo por dosis:', options: ['$100', '$200', '$250', '$500'], correctIndex: 2, explanation: 'Total dosis por frasco: 200ml / 10ml = 20 dosis. Costo por dosis: $5.000 / 20 = $250.' },
                    { id: 440, topic: 'Gesti칩n', text: 'Inventario valorizado es:', options: ['Cantidad de productos', 'Suma del costo de todos los productos', 'Suma del precio de venta', 'Productos por vencer'], correctIndex: 1, explanation: 'Valor total del stock a precio de costo.' }
                ] 
            }
        ];

        // --- PDFS ---
        const PDF_DOCS = [
            { title: 'Ley 20.724 (Ley de F치rmacos)', desc: 'Modifica el C칩digo Sanitario', file: 'ley_20724.pdf' },
            { title: 'Decreto Supremo 466', desc: 'Reglamento de Farmacias', file: 'decreto_466.pdf' },
            { title: 'Decreto Supremo 404', desc: 'Reglamento de Estupefacientes', file: 'decreto_404.pdf' },
            { title: 'Decreto Supremo 405', desc: 'Reglamento de Psicotr칩picos', file: 'decreto_405.pdf' }
        ];

        // --- COMPONENTES UI (Sin cambios) ---
        const Icon = ({ name, size = 20, className = "", weight = "regular" }) => {
            const map = {
                'user': 'ph-user', 'shield': 'ph-shield-check', 'lock': 'ph-lock', 'check-circle': 'ph-check-circle',
                'book': 'ph-book-open', 'book-open': 'ph-book-open', 'arrow-left': 'ph-arrow-left', 'x': 'ph-x', 'caret-right': 'ph-caret-right',
                'caret-down': 'ph-caret-down', 'files': 'ph-files', 'users': 'ph-users', 'house': 'ph-house', 
                'file-pdf': 'ph-file-pdf', 'trophy': 'ph-trophy', 'warning': 'ph-warning-circle', 'eye': 'ph-eye', 
                'refresh': 'ph-arrows-clockwise', 'whatsapp': 'ph-whatsapp-logo', 'facebook': 'ph-facebook-logo', 
                'download': 'ph-download-simple', 'student': 'ph-student', 'question': 'ph-question', 'medal': 'ph-medal', 
                'power': 'ph-power', 'coffee': 'ph-coffee', 'chat-circle': 'ph-chat-circle', 'article': 'ph-article'
            };
            return <i className={`${map[name] || 'ph-circle'} ${className}`} style={{ fontSize: size, fontWeight: weight === 'fill' ? 'bold' : 'normal' }}></i>;
        };

        const Button = ({ onClick, children, variant = 'primary', className = '', fullWidth = false }) => {
            const base = "flex items-center justify-center gap-2 px-5 py-3.5 rounded-xl font-bold transition-all active:scale-95 text-sm md:text-base";
            const variants = {
                primary: "bg-slate-900 text-white hover:bg-slate-800 shadow-lg hover:shadow-xl",
                secondary: "bg-farmacia-green text-white hover:bg-green-600 shadow-md",
                outline: "bg-white border-2 border-slate-200 text-slate-600 hover:border-farmacia-green hover:text-farmacia-green",
                ghost: "text-slate-500 hover:bg-slate-100",
                danger: "bg-red-50 text-red-500 hover:bg-red-100 border border-red-100"
            };
            return <button onClick={onClick} className={`${base} ${variants[variant]} ${fullWidth ? 'w-full' : ''} ${className}`}>{children}</button>;
        };

        const Accordion = ({ title, content }) => {
            const [isOpen, setIsOpen] = useState(false);
            return (
                <div className="border-b border-slate-100 last:border-0">
                    <button onClick={() => setIsOpen(!isOpen)} className="w-full flex justify-between items-center py-4 text-left font-medium text-slate-700 hover:text-farmacia-green transition-colors">
                        {title}
                        <Icon name="caret-down" className={`transition-transform duration-300 ${isOpen ? 'rotate-180' : ''}`} />
                    </button>
                    <div className={`overflow-hidden transition-all duration-300 ${isOpen ? 'max-h-96 pb-4' : 'max-h-0'}`}>
                        <div className="text-sm text-slate-500 leading-relaxed html-content" dangerouslySetInnerHTML={{__html: content}}></div>
                    </div>
                </div>
            );
        };

        // --- APP PRINCIPAL ---
        function App() {
            const [view, setView] = useState('LANDING'); 
            const [user, setUser] = useState({ name: '', currentLevel: 1, completedLevels: [], isAuthenticated: false });
            const [quizState, setQuizState] = useState({ active: false, levelId: null, qIndex: 0, score: 0, showResult: false, answers: [] });
            const [reviewMode, setReviewMode] = useState(false);
            const [activeModal, setActiveModal] = useState(null); 
            const [authMode, setAuthMode] = useState('login');
            const [legalTab, setLegalTab] = useState('terms');
            const [selectedArticle, setSelectedArticle] = useState(null);

            useEffect(() => {
                const unsubscribe = onAuthStateChanged(auth, (u) => {
                    if (u) {
                        const ref = doc(db, 'artifacts', appId, 'users', u.uid, 'data', 'progress');
                        onSnapshot(ref, (snap) => {
                            if (snap.exists()) {
                                const d = snap.data();
                                setUser({ ...d, uid: u.uid, isAuthenticated: true });
                            } else {
                                setUser({ name: u.displayName || 'Colega', currentLevel: 1, completedLevels: [], isAuthenticated: true, uid: u.uid });
                            }
                        });
                    } else {
                        const local = JSON.parse(localStorage.getItem(LOCAL_STORAGE_KEY) || '{}');
                        if (local.isAuthenticated) setUser(local);
                    }
                });
                return () => unsubscribe();
            }, []);

            const saveProgress = async (newLevel, newCompleted) => {
                const updatedUser = { ...user, currentLevel: newLevel, completedLevels: newCompleted };
                setUser(updatedUser);
                localStorage.setItem(LOCAL_STORAGE_KEY, JSON.stringify(updatedUser));
                if (user.uid) {
                    try { await setDoc(doc(db, 'artifacts', appId, 'users', user.uid, 'data', 'progress'), updatedUser, { merge: true }); } catch(e) {}
                }
            };

            const goBack = () => {
                // L칩gica unificada: Siempre vuelve a LANDING desde todas las vistas p칰blicas (Blog, FAQs, Library)
                // Desde el Panel de Estudio, si es que hubiera sub-navegaci칩n, volver칤a al Panel.
                if (view === 'ARTICLE') {
                    setView('BLOG');
                } else if (view === 'DASHBOARD') {
                    // Si est치s en el Dashboard y quieres "volver" (l칩gica rara, pero por seguridad), vas a Landing
                    setView('LANDING');
                } else {
                    // Desde FAQs, Library, Blog -> Siempre a Landing
                    setView('LANDING');
                }
            };

            // ... [VISTAS LANDING, DASHBOARD, BLOG, ETC - IGUAL QUE ANTES] ...
            // Mantenemos la misma estructura de renderizado pero usando los nuevos LEVELS con preguntas 칰nicas.

            const renderLanding = () => (
                <div className="flex-1 flex flex-col animate-fade-in overflow-y-auto relative z-10 bg-white">
                    <header className="w-full py-4 px-6 flex justify-between items-center border-b border-slate-100 bg-white/95 backdrop-blur-sm sticky top-0 z-30 shadow-sm">
                        <div className="flex items-center gap-2 text-xl font-heading font-bold text-slate-800 cursor-pointer" onClick={() => setView('LANDING')}>
                            <img src="https://raw.githubusercontent.com/marcar1972-cyber/Auxiliar--pro/34923cb127c2feede55ec712bdc0261f1b23da3c/logo_auxiliarpro_3_400x240_ajustado.png" alt="Logo AuxiliarPro" className="h-24 w-auto object-contain" />
                        </div>
                        <div className="flex items-center gap-2">
                            <button onClick={() => setView('BLOG')} className="text-sm font-bold text-slate-500 hover:text-farmacia-green transition-colors mr-2 hidden md:block">Blog</button>
                            <button onClick={() => user.isAuthenticated ? setView('DASHBOARD') : setActiveModal('auth')} className="text-sm font-bold text-slate-500 hover:text-farmacia-green transition-colors">
                                {user.isAuthenticated ? 'Ir a mi Panel' : 'Ingresar'}
                            </button>
                        </div>
                    </header>
                    <main className="flex-1 flex flex-col">
                        <section className="px-6 py-10 text-center max-w-lg mx-auto">
                            <div className="inline-flex items-center gap-2 bg-emerald-50 border border-emerald-100 text-emerald-700 text-[10px] font-bold px-3 py-1.5 rounded-full mb-6 tracking-wide shadow-sm">
                                <span className="w-1.5 h-1.5 rounded-full bg-emerald-500 animate-pulse"></span> META: CREDENCIAL 2026
                            </div>
                            <h1 className="text-4xl md:text-5xl font-extrabold text-slate-900 mb-6 leading-tight tracking-tight">
                                Prep치rate para tu <br/><span className="text-transparent bg-clip-text bg-gradient-to-r from-farmacia-green to-emerald-600">Examen de Auxiliar</span>
                            </h1>
                            <div className="space-y-3 w-full max-w-xs mx-auto">
                                <Button fullWidth onClick={() => user.isAuthenticated ? setView('DASHBOARD') : setActiveModal('auth')}>
                                    Comenzar Ahora <Icon name="caret-right" />
                                </Button>
                                <Button variant="outline" fullWidth onClick={() => setView('BLOG')}>
                                    <Icon name="article" /> Ir a leer Art칤culos
                                </Button>
                            </div>
                        </section>
                        <section className="bg-slate-50 py-12 px-6 border-y border-slate-100">
                            <div className="max-w-md mx-auto">
                                <div className="flex items-center gap-4 mb-6">
                                    <div className="w-12 h-12 bg-white rounded-full flex items-center justify-center text-slate-700 shadow-sm border border-slate-100 text-xl"><Icon name="student" /></div>
                                    <div>
                                        <h3 className="font-bold text-slate-800">Hola, soy Marcelo</h3>
                                        <p className="text-xs text-slate-500 uppercase tracking-wider font-bold">Auxiliar Trainee</p>
                                    </div>
                                </div>
                                <p className="text-slate-600 text-sm leading-relaxed">
                                    <strong>AuxiliarPro</strong> se cre칩 bajo la convicci칩n de que el conocimiento debe ser accesible y compartido. Esta plataforma nace como un espacio de estudio abierto para todos quienes buscan profesionalizar su labor como vendedor de farmacia y lograr la tan preciada credencial.
                                </p>
                                <div className="mt-8 p-5 bg-yellow-50 border border-yellow-200 rounded-xl text-center shadow-sm">
                                    <p className="text-sm text-slate-700 mb-3 font-medium">쯊e sirve este material?</p>
                                    <a href="https://app.reveniu.com/checkout-custom-link/HvM4DkkkUpBnILnQv4abrZl5qYX7faqU" target="_blank" rel="noopener noreferrer" className="bg-yellow-400 hover:bg-yellow-500 text-slate-900 px-4 py-2 rounded-lg font-bold text-sm flex items-center justify-center gap-2 w-full transition-colors shadow-sm no-underline">
                                        <Icon name="coffee" size={20} /> Inv칤tame un caf칠 / Colaborar
                                    </a>
                                </div>
                            </div>
                        </section>
                        <section className="py-10 px-6 max-w-md mx-auto w-full text-center">
                            <h3 className="font-bold text-slate-800 mb-4 text-lg">쮻udas sobre el proceso?</h3>
                            <Button variant="outline" fullWidth onClick={() => setView('FAQS')}><Icon name="question" /> Ver Preguntas Frecuentes</Button>
                        </section>
                        <footer className="bg-slate-900 text-slate-400 py-10 px-6 text-center text-xs">
                            <div className="flex justify-center gap-6 mb-6 font-bold uppercase tracking-wider text-slate-500">
                                <button onClick={() => { setLegalTab('terms'); setActiveModal('legal'); }} className="hover:text-white">T칠rminos</button>
                                <button onClick={() => { setLegalTab('privacy'); setActiveModal('legal'); }} className="hover:text-white">Privacidad</button>
                                <button onClick={() => { setLegalTab('disclaimers'); setActiveModal('legal'); }} className="hover:text-white">Descargos</button>
                            </div>
                            <p className="opacity-60">춸 2025 AuxiliarPro</p>
                        </footer>
                    </main>
                </div>
            );

            const renderDashboard = () => (
                <div className="flex-1 flex flex-col bg-slate-50 h-full animate-fade-in absolute inset-0 z-20">
                    <header className="bg-white shadow-sm p-4 sticky top-0 z-20 flex justify-between items-center border-b border-slate-100">
                        <div class="cursor-pointer" onClick={() => setView('LANDING')}>
                            <h2 className="font-bold text-lg text-slate-800">Panel de Estudio</h2>
                            <p className="text-xs text-slate-500">Hola, {user.name.split(' ')[0]}</p>
                        </div>
                        <div className="flex gap-2">
                            <button onClick={() => setView('BLOG')} className="p-2 bg-white border border-slate-200 rounded-lg text-slate-400 hover:text-farmacia-green hover:border-green-200 transition-colors shadow-sm flex items-center gap-2 text-xs font-bold" title="Blog"><Icon name="article" size={20}/><span className="hidden md:inline">Blog</span></button>
                            <button onClick={() => setActiveModal('community')} className="p-2 bg-white border border-slate-200 rounded-lg text-slate-400 hover:text-blue-600 hover:border-blue-200 transition-colors shadow-sm flex items-center gap-2 text-xs font-bold" title="Comunidad"><Icon name="users" size={20}/><span className="hidden md:inline">Comunidad</span></button>
                            <button onClick={async () => { await signOut(auth); localStorage.removeItem(LOCAL_STORAGE_KEY); setView('LANDING'); }} className="p-2 bg-white border border-slate-200 rounded-lg text-slate-400 hover:text-red-500 hover:border-red-200 transition-colors shadow-sm flex items-center gap-2 text-xs font-bold"><Icon name="power" size={20}/><span className="hidden md:inline">Salir</span></button>
                        </div>
                    </header>
                    <main className="flex-1 p-6 overflow-y-auto pb-24">
                        <div className="max-w-md mx-auto space-y-6">
                            <div className="bg-slate-900 rounded-2xl p-6 text-white shadow-lg relative overflow-hidden">
                                <div className="relative z-10">
                                    <div className="flex justify-between items-center mb-4">
                                        <span className="text-xs font-bold text-slate-400 uppercase tracking-wider">Avance Global</span>
                                        <span className="text-emerald-400 font-bold text-2xl">{Math.round((user.completedLevels.length / LEVELS.length) * 100)}%</span>
                                    </div>
                                    <div className="w-full bg-slate-700 h-2 rounded-full overflow-hidden"><div className="bg-emerald-500 h-full rounded-full transition-all duration-1000" style={{ width: `${(user.completedLevels.length / LEVELS.length) * 100}%` }}></div></div>
                                    <p className="text-xs text-slate-400 mt-4">Has completado {user.completedLevels.length} de {LEVELS.length} niveles.</p>
                                </div>
                                <Icon name="trophy" className="absolute -right-4 -bottom-4 text-slate-800 text-9xl opacity-20 rotate-12" />
                            </div>
                            <div className="space-y-4">
                                {LEVELS.map(level => {
                                    const isLocked = level.id > user.currentLevel;
                                    const isCompleted = user.completedLevels.includes(level.id);
                                    return (
                                        <div key={level.id} onClick={() => !isLocked && startQuiz(level.id)} className={`relative p-5 rounded-2xl border-2 transition-all flex items-center gap-4 cursor-pointer group overflow-hidden ${isLocked ? 'bg-slate-100 border-slate-200 opacity-60' : 'bg-white hover:shadow-lg ' + level.borderColor} ${isCompleted ? 'bg-emerald-50/30 border-emerald-200' : ''}`}>
                                            <div className={`w-14 h-14 rounded-full flex items-center justify-center text-2xl shadow-sm relative z-10 ${isCompleted ? 'shiny-effect ' + level.iconBg + ' text-white border-2 border-white shadow-md' : (isLocked ? 'bg-slate-200 text-slate-400' : level.iconBg + ' text-white')}`}>{isCompleted ? <Icon name="medal" /> : (isLocked ? <Icon name="lock" /> : <Icon name="trophy" />)}</div>
                                            <div className="flex-1 z-10">
                                                <div className="flex justify-between items-start"><h3 className="font-bold text-slate-800">{level.title}</h3>{isCompleted && <span className="text-[10px] font-bold px-2 py-0.5 rounded bg-emerald-100 text-emerald-700 border border-emerald-200">LOGRADO</span>}{!isLocked && !isCompleted && <span className={`text-[10px] font-bold px-2 py-0.5 rounded uppercase bg-slate-100 text-slate-600 border border-slate-200`}>{level.medal}</span>}</div>
                                                <p className="text-xs text-slate-500 mt-1">{level.desc}</p>
                                                <p className="text-[10px] text-slate-400 mt-2 font-bold uppercase tracking-wide flex items-center gap-1"><Icon name="files" size={12}/> {level.qCount} Preguntas</p>
                                            </div>
                                            {!isLocked && <Icon name="caret-right" className="text-slate-300 group-hover:text-farmacia-green transition-colors z-10" />}
                                        </div>
                                    );
                                })}
                            </div>
                            <div className="grid grid-cols-2 gap-3">
                                <Button variant="outline" fullWidth onClick={() => setView('LIBRARY')}><Icon name="file-pdf" /> Biblioteca</Button>
                                <Button variant="outline" fullWidth onClick={() => setActiveModal('community')}><Icon name="chat-circle" /> Foro</Button>
                            </div>
                        </div>
                    </main>
                </div>
            );

            const renderFAQs = () => (
                <div className="flex-1 flex flex-col bg-white h-full animate-slide-up absolute inset-0 z-30">
                    <header className="bg-white shadow-sm py-4 px-6 flex items-center gap-3 sticky top-0 z-10 border-b border-slate-100"><button onClick={() => setView('LANDING')} className="flex items-center gap-1 text-slate-600 font-medium hover:text-farmacia-green"><Icon name="arrow-left" size={20}/> Volver al Inicio</button><span className="font-bold text-lg text-slate-800 ml-auto">Preguntas Frecuentes</span></header>
                    <main className="flex-1 p-6 overflow-y-auto bg-slate-50"><div className="max-w-md mx-auto bg-white p-6 rounded-2xl shadow-sm border border-slate-100"><h2 className="text-xl font-bold text-slate-800 mb-4">Proceso de Acreditaci칩n</h2><p className="text-sm text-slate-500 mb-6">Informaci칩n clave sobre el examen y tr치mites ante la SEREMI.</p><div className="space-y-1">{FAQS.map((faq, i) => <Accordion key={i} title={faq.q} content={faq.a} />)}</div><div className="mt-8 pt-6 border-t border-slate-100 text-center"><Button variant="outline" fullWidth onClick={() => setView('LANDING')}>Volver al Inicio</Button></div></div></main>
                </div>
            );

            const renderBlog = () => (
                <div className="flex-1 flex flex-col bg-white h-full animate-slide-up absolute inset-0 z-30">
                    <header className="bg-white shadow-sm py-4 px-6 flex items-center gap-3 sticky top-0 z-10 border-b border-slate-100"><button onClick={() => setView('LANDING')} className="flex items-center gap-1 text-slate-600 font-medium hover:text-farmacia-green"><Icon name="arrow-left" size={20}/> Volver al Inicio</button><span className="font-bold text-lg text-slate-800 ml-auto">Blog de Estudio</span></header>
                    <main className="flex-1 p-6 overflow-y-auto bg-slate-50"><div className="space-y-4 max-w-md mx-auto">{BLOG_POSTS.map(post => (<article key={post.id} onClick={() => { setSelectedArticle(post); setView('ARTICLE'); }} className="bg-white p-5 rounded-2xl border border-slate-100 shadow-sm hover:shadow-md transition-all cursor-pointer transform hover:-translate-y-1 duration-200"><div className="flex justify-between items-start mb-3"><span className="text-[10px] font-bold text-farmacia-green bg-green-50 px-2 py-1 rounded uppercase tracking-wide">{post.category}</span><span className="text-xs text-slate-400 font-medium">{post.date}</span></div><h3 className="font-bold text-slate-800 text-lg mb-2 leading-snug">{post.title}</h3><p className="text-sm text-slate-500 leading-relaxed line-clamp-3">{post.excerpt}</p><button className="mt-4 text-sm text-farmacia-green font-bold flex items-center gap-1 hover:gap-2 transition-all">Leer Art칤culo <Icon name="caret-right" size={14} /></button></article>))}</div></main>
                </div>
            );

            const renderArticle = () => {
                if (!selectedArticle) return null;
                return (
                    <div className="flex-1 flex flex-col bg-white h-full animate-slide-up absolute inset-0 z-40">
                        <header className="bg-white shadow-sm py-4 px-6 flex items-center gap-3 sticky top-0 z-10 border-b border-slate-100"><button onClick={() => setView('BLOG')} className="flex items-center gap-1 text-slate-600 font-medium hover:text-farmacia-green"><Icon name="arrow-left" size={20}/> Volver al Blog</button></header>
                        <main className="flex-1 p-6 overflow-y-auto"><div className="max-w-2xl mx-auto blog-content"><span className="text-xs font-bold text-farmacia-green bg-green-50 px-2 py-1 rounded uppercase tracking-wide mb-4 inline-block">{selectedArticle.category}</span><div dangerouslySetInnerHTML={{__html: selectedArticle.content}}></div><div className="mt-8 pt-6 border-t border-slate-100 text-center"><Button variant="outline" fullWidth onClick={() => setView('BLOG')}>Volver a Art칤culos</Button></div></div></main>
                    </div>
                );
            };

            const renderLibrary = () => (
                <div className="flex-1 flex flex-col bg-white h-full animate-slide-up absolute inset-0 z-30">
                    <header className="p-4 border-b border-gray-100 flex items-center gap-3 bg-white sticky top-0 z-20"><button onClick={() => setView(user.isAuthenticated ? 'DASHBOARD' : 'LANDING')}><Icon name="arrow-left" size={24} className="text-slate-600"/></button><h2 className="font-bold text-lg text-slate-800">Biblioteca Legal</h2></header>
                    <main className="flex-1 p-6 overflow-y-auto"><div className="max-w-md mx-auto"><p className="text-sm text-gray-500 mb-6">Gu칤as de estudio y res칰menes basados en los decretos del MINSAL.</p><div className="space-y-3">{PDF_DOCS.map((doc, i) => (<a key={i} href={doc.file} target="_blank" className="flex items-center gap-4 p-4 rounded-xl border border-gray-100 hover:border-red-200 hover:bg-red-50 transition-colors group cursor-pointer no-underline"><div className="bg-red-100 text-red-500 p-3 rounded-lg"><Icon name="file-pdf" size={24}/></div><div className="flex-1"><h4 className="font-bold text-gray-800 group-hover:text-red-600">{doc.title}</h4><p className="text-xs text-gray-500">{doc.desc}</p></div><Icon name="download" className="text-gray-300 group-hover:text-red-500" /></a>))}</div><div className="mt-8 pt-6 border-t border-slate-100 text-center"><Button variant="outline" fullWidth onClick={() => setView(user.isAuthenticated ? 'DASHBOARD' : 'LANDING')}>Volver al Panel</Button></div></div></main>
                </div>
            );

            const startQuiz = (lvlId) => {
                const level = LEVELS.find(l => l.id === lvlId);
                setQuizState({ active: true, levelId: lvlId, qIndex: 0, score: 0, showResult: false, answers: [] });
                setReviewMode(false);
            };

            const handleAnswer = (idx) => {
                const lvl = LEVELS.find(l => l.id === quizState.levelId);
                const q = lvl.questions[quizState.qIndex % lvl.questions.length];
                const isCorrect = idx === q.correctIndex;
                const newScore = isCorrect ? quizState.score + 1 : quizState.score;
                const newAnswers = [...quizState.answers, idx];

                if (quizState.qIndex + 1 < lvl.qCount) {
                    setQuizState({ ...quizState, qIndex: quizState.qIndex + 1, score: newScore, answers: newAnswers });
                } else {
                    const passed = newScore >= lvl.passingScore;
                    if (passed) {
                        if (window.confetti) window.confetti();
                        const nextLvl = lvl.id === user.currentLevel ? user.currentLevel + 1 : user.currentLevel;
                        const nextCompleted = user.completedLevels.includes(lvl.id) ? user.completedLevels : [...user.completedLevels, lvl.id];
                        saveProgress(nextLvl, nextCompleted);
                    }
                    setQuizState({ ...quizState, showResult: true, score: newScore, answers: newAnswers });
                }
            };

            const renderQuizModal = () => {
                if (!quizState.active) return null;
                const lvl = LEVELS.find(l => l.id === quizState.levelId);
                const qRealIndex = quizState.qIndex % lvl.questions.length;
                const q = lvl.questions[qRealIndex];
                const passed = quizState.score >= lvl.passingScore;

                const wrongTopics = [];
                if (quizState.showResult) {
                    quizState.answers.forEach((ans, i) => {
                        if (ans !== lvl.questions[i].correctIndex) {
                            const topic = lvl.questions[i].topic;
                            if (!wrongTopics.includes(topic)) wrongTopics.push(topic);
                        }
                    });
                }

                return (
                    <div className="absolute inset-0 z-50 bg-white flex flex-col animate-slide-up">
                        <header className="bg-farmacia-dark text-white p-4 flex justify-between items-center shadow-lg sticky top-0 z-20">
                            <div><h3 className="font-bold">{lvl.title}</h3><p className="text-xs opacity-70">{!quizState.showResult ? `Pregunta ${quizState.qIndex + 1} de ${lvl.qCount}` : 'Resultados'}</p></div>
                            <button onClick={() => setQuizState({ ...quizState, active: false })}><Icon name="x" size={24} /></button>
                        </header>
                        <main className="flex-1 p-6 overflow-y-auto bg-slate-50">
                            {!quizState.showResult ? (
                                <div className="max-w-md mx-auto h-full flex flex-col">
                                    <div className="mb-6 flex-1"><span className="text-[10px] font-bold text-farmacia-green bg-green-50 px-2 py-1 rounded mb-2 inline-block border border-green-100 uppercase">{lvl.examLabel || 'SIMULACRO'}</span><h2 className="text-xl font-bold text-gray-800 leading-snug">{q.text}</h2></div>
                                    <div className="space-y-3 mb-8">{q.options.map((opt, i) => (<button key={i} onClick={() => handleAnswer(i)} className="w-full text-left p-4 border-2 border-gray-100 bg-white rounded-xl hover:border-farmacia-green hover:bg-green-50 transition-all font-medium text-gray-700 flex items-center gap-3 group shadow-sm"><span className="w-8 h-8 inline-flex items-center justify-center bg-slate-100 group-hover:bg-white rounded-full text-xs font-bold text-gray-500 group-hover:text-farmacia-green transition-colors">{String.fromCharCode(65+i)}</span><span className="flex-1">{opt}</span></button>))}</div>
                                    <div className="mt-auto pt-4 border-t border-slate-200"><Button variant="danger" fullWidth onClick={() => setQuizState({ ...quizState, active: false })}>Cancelar y Volver al Panel</Button></div>
                                </div>
                            ) : (
                                <div className="text-center max-w-md mx-auto pt-4">
                                    <div className="mb-8"><div className="text-7xl mb-4">{passed ? '游꿉' : '游닄'}</div><h2 className="text-2xl font-bold text-gray-900 mb-2">{passed ? '춰Nivel Aprobado!' : 'Sigue Estudiando'}</h2><p className="text-gray-500">Lograste {quizState.score} de {lvl.qCount} respuestas correctas</p></div>
                                    {!reviewMode && (
                                        <div className="bg-white p-5 rounded-2xl mb-8 text-left border border-slate-100 shadow-sm">
                                            <h4 className="font-bold text-slate-800 mb-3 border-b border-slate-100 pb-2 flex items-center gap-2"><Icon name="files" /> An치lisis de Resultados</h4>
                                            <div className="space-y-3 text-sm">
                                                <div className="flex justify-between"><span className="text-slate-500">Estado:</span><span className={`font-bold ${passed ? 'text-farmacia-green' : 'text-red-500'}`}>{passed ? 'APROBADO' : 'REPROBADO'}</span></div>
                                                {/* FEEDBACK MEJORADO - SIEMPRE VISIBLE SI HAY ERRORES */}
                                                {wrongTopics.length > 0 ? (
                                                    <div className="mt-3 p-3 bg-red-50 rounded-lg border border-red-100">
                                                        <p className="text-xs font-bold text-red-500 uppercase mb-1">Debes reforzar:</p>
                                                        <ul className="list-disc pl-4 text-slate-700 mb-3">{wrongTopics.slice(0, 3).map(t => <li>{t}</li>)}</ul>
                                                        <button 
                                                            onClick={() => { setQuizState({ ...quizState, active: false }); setView('LIBRARY'); }}
                                                            className="w-full bg-red-100 hover:bg-red-200 text-red-700 font-bold py-2 rounded-lg text-xs flex items-center justify-center gap-2 transition-colors"
                                                        >
                                                            <Icon name="book-open" /> Ir a la Biblioteca a Repasar
                                                        </button>
                                                    </div>
                                                ) : (
                                                    <div className="mt-3 p-3 bg-green-50 rounded-lg border border-green-100"><p className="text-xs font-bold text-green-600 uppercase mb-1">춰Excelente trabajo!</p><p className="text-slate-700">Dominas los conceptos clave. 춰Sigue as칤!</p></div>
                                                )}
                                            </div>
                                        </div>
                                    )}
                                    {reviewMode && <div className="text-left space-y-4 mb-8">{lvl.questions.map((qs, i) => <div key={i} className="bg-white border p-4 rounded-xl text-sm shadow-sm"><p className="font-bold mb-2 text-slate-800">{qs.text}</p><p className={quizState.answers[i] === qs.correctIndex ? 'text-farmacia-green font-bold' : 'text-red-500 line-through'}>Tu: {qs.options[quizState.answers[i]]}</p>{quizState.answers[i] !== qs.correctIndex && <p className="text-farmacia-green font-bold mt-1">Correcta: {qs.options[qs.correctIndex]}</p>}</div>)}</div>}
                                    <div className="space-y-3 sticky bottom-0 bg-white p-4 border-t border-slate-100 shadow-xl rounded-t-2xl">{!reviewMode && <Button fullWidth variant="outline" onClick={() => setReviewMode(true)}><Icon name="eye" /> Revisar mis Errores</Button>}<Button fullWidth onClick={() => startQuiz(lvl.id)}><Icon name="refresh" /> Reintentar Nivel</Button><button onClick={() => setQuizState({ ...quizState, active: false })} className="text-sm text-slate-400 underline py-2">Volver al Panel</button></div>
                                </div>
                            )}
                        </main>
                    </div>
                );
            };

            // MODALES EXTRAS
            const AuthModal = () => {
                if (activeModal !== 'auth') return null;
                const [form, setForm] = useState({ name: '', email: '', pass: '' });
                const [error, setError] = useState('');
                const handleSubmit = async (e) => {
                    e.preventDefault();
                    setError('');
                    try {
                        if (authMode === 'register') {
                            const cred = await createUserWithEmailAndPassword(auth, form.email, form.pass);
                            await updateProfile(cred.user, { displayName: form.name });
                            await setDoc(doc(db, 'artifacts', appId, 'users', cred.user.uid, 'data', 'progress'), { name: form.name, currentLevel: 1, completedLevels: [], lastUpdate: new Date() });
                        } else {
                            await signInWithEmailAndPassword(auth, form.email, form.pass);
                        }
                        setActiveModal(null);
                        setView('DASHBOARD');
                    } catch (err) { setError(err.code === 'auth/wrong-password' ? 'Contrase침a incorrecta' : 'Error en los datos'); }
                };
                return (
                    <div className="fixed inset-0 z-50 bg-slate-900/50 backdrop-blur-sm flex items-center justify-center p-4 animate-fade-in">
                        <div className="bg-white rounded-3xl w-full max-w-sm p-8 relative shadow-2xl">
                            <button onClick={() => setActiveModal(null)} className="absolute top-6 right-6 text-slate-300 hover:text-slate-600"><Icon name="x" size={24}/></button>
                            <div className="text-center mb-8">
                                <div className="bg-emerald-100 w-16 h-16 rounded-2xl flex items-center justify-center mx-auto mb-4 text-emerald-600 text-3xl shadow-sm"><Icon name="user" /></div>
                                <h2 className="text-2xl font-bold text-slate-800">{authMode === 'register' ? 'Crear Cuenta' : 'Bienvenido'}</h2>
                                <p className="text-sm text-slate-500 mt-2">칔nete a la comunidad de AuxiliarPro.</p>
                            </div>
                            <form onSubmit={handleSubmit} className="space-y-4">
                                {authMode === 'register' && <input type="text" placeholder="Tu Nombre" className="w-full p-4 bg-slate-50 border-none rounded-xl focus:ring-2 focus:ring-emerald-500 outline-none transition-all" required onChange={e => setForm({...form, name: e.target.value})} />}
                                <input type="email" placeholder="Correo Electr칩nico" className="w-full p-4 bg-slate-50 border-none rounded-xl focus:ring-2 focus:ring-emerald-500 outline-none transition-all" required onChange={e => setForm({...form, email: e.target.value})} />
                                <input type="password" placeholder="Contrase침a" className="w-full p-4 bg-slate-50 border-none rounded-xl focus:ring-2 focus:ring-emerald-500 outline-none transition-all" required onChange={e => setForm({...form, pass: e.target.value})} />
                                {error && <p className="text-red-500 text-xs text-center font-bold">{error}</p>}
                                <Button fullWidth type="submit" className="py-4 shadow-xl shadow-emerald-200">{authMode === 'register' ? 'Registrarse Gratis' : 'Entrar'}</Button>
                            </form>
                            <button onClick={() => setAuthMode(authMode === 'login' ? 'register' : 'login')} className="block w-full text-center mt-6 text-sm text-slate-500 font-medium hover:text-farmacia-green transition-colors">{authMode === 'login' ? '쯅o tienes cuenta? Reg칤strate aqu칤' : '쯏a tienes cuenta? Inicia Sesi칩n'}</button>
                        </div>
                    </div>
                );
            };

            const LegalModal = () => {
                if (activeModal !== 'legal') return null;
                const contents = {
                    // --- TEXTOS LEGALES (NO MODIFICAR SIN AUTORIZACI칍N) ---
                    terms: "T칠rminos de Uso:\nEsta aplicaci칩n, 'AuxiliarPro', es una herramienta educativa dise침ada para asistir en la preparaci칩n del examen de Auxiliar de Farmacia. El uso de esta plataforma implica la aceptaci칩n de los siguientes t칠rminos y condiciones. El contenido proporcionado es con fines informativos y educativos, y no sustituye el consejo profesional o la informaci칩n oficial otorgada por las autoridades sanitarias. Los usuarios son responsables de verificar la informaci칩n y utilizarla de manera 칠tica y legal. AuxiliarPro se reserva el derecho de modificar, suspender o cancelar el servicio en cualquier momento, as칤 como de actualizar estos t칠rminos sin previo aviso. El acceso a ciertas funciones puede requerir registro, siendo el usuario responsable de mantener la confidencialidad de sus credenciales. Queda prohibido el uso de la plataforma para fines ilegales o no autorizados, incluyendo pero no limitado a la distribuci칩n de contenido con derechos de autor, spam o malware. AuxiliarPro no se hace responsable por da침os o perjuicios derivados del uso de la aplicaci칩n, incluyendo p칠rdida de datos o interrupciones del servicio. Al utilizar AuxiliarPro, el usuario acepta someterse a la jurisdicci칩n de los tribunales chilenos para cualquier disputa que pueda surgir.",
                    privacy: "Pol칤tica de Privacidad:\nEn AuxiliarPro, respetamos tu privacidad y nos comprometemos a proteger tus datos personales. Esta pol칤tica describe c칩mo recopilamos, usamos y compartimos tu informaci칩n. Al utilizar nuestra aplicaci칩n, aceptas las pr치cticas descritas en esta pol칤tica. Recopilamos informaci칩n que nos proporcionas directamente, como tu nombre, correo electr칩nico y progreso en los cuestionarios, con el fin de personalizar tu experiencia y mejorar nuestro servicio. Tambi칠n podemos recopilar informaci칩n t칠cnica autom치ticamente, como tu direcci칩n IP y tipo de dispositivo, para fines de an치lisis y seguridad. No compartimos tu informaci칩n personal con terceros, excepto cuando sea necesario para cumplir con la ley, proteger nuestros derechos o proporcionar servicios esenciales (como el alojamiento de la aplicaci칩n). Utilizamos cookies y tecnolog칤as similares para mejorar la funcionalidad y el rendimiento de la plataforma. Puedes configurar tu navegador para rechazar las cookies, pero esto puede afectar tu experiencia de usuario. Implementamos medidas de seguridad para proteger tus datos, pero no podemos garantizar la seguridad absoluta de la informaci칩n transmitida a trav칠s de Internet. Esta pol칤tica puede actualizarse peri칩dicamente, por lo que te recomendamos revisarla regularmente.",
                    disclaimers: "Descargos de Responsabilidad:\n1. Independencia: AuxiliarPro es una iniciativa independiente y NO tiene afiliaci칩n, respaldo ni patrocinio alguno por parte del Ministerio de Salud (MINSAL), el Instituto de Salud P칰blica (ISP), las SEREMIS de Salud o cualquier otra entidad gubernamental o autoridad sanitaria de Chile. La informaci칩n y los materiales proporcionados en esta plataforma se basan en fuentes p칰blicas y en el conocimiento general sobre el examen de Auxiliar de Farmacia, pero no constituyen informaci칩n oficial.\n\n2. Exactitud de la Informaci칩n: Aunque nos esforzamos por mantener la informaci칩n actualizada y precisa, AuxiliarPro no garantiza la exactitud, integridad o vigencia del contenido. La legislaci칩n y las normativas sanitarias pueden cambiar, y es responsabilidad del usuario verificar la informaci칩n con las fuentes oficiales correspondientes antes de tomar decisiones basadas en ella.\n\n3. Prop칩sito Educativo: El contenido de AuxiliarPro tiene fines exclusivamente educativos e informativos. No debe considerarse como asesoramiento profesional, m칠dico, legal o de cualquier otra 칤ndole. El uso de la plataforma y la confianza en su contenido son bajo el propio riesgo del usuario.\n\n4. Resultados del Examen: El uso de AuxiliarPro no garantiza la aprobaci칩n del examen de Auxiliar de Farmacia ni la obtenci칩n de la credencial sanitaria. El 칠xito en el examen depende del estudio individual, la preparaci칩n y otros factores ajenos a la plataforma.\n\n5. Enlaces Externos: AuxiliarPro puede contener enlaces a sitios web de terceros. No nos hacemos responsables por el contenido, las pol칤ticas de privacidad o las pr치cticas de estos sitios externos.\n\n6. Limitaci칩n de Responsabilidad: En ning칰n caso AuxiliarPro ser치 responsable por da침os directos, indirectos, incidentales, especiales o consecuentes que surjan del uso o la imposibilidad de uso de la plataforma, incluso si se ha advertido sobre la posibilidad de tales da침os."
                };
                return (
                    <div className="fixed inset-0 z-50 bg-slate-900/60 backdrop-blur-sm flex items-center justify-center p-4 animate-fade-in">
                        <div className="bg-white rounded-3xl w-full max-w-lg p-8 relative shadow-2xl flex flex-col max-h-[85vh]">
                            <button onClick={() => setActiveModal(null)} className="absolute top-6 right-6 text-slate-400 hover:text-slate-800 transition-colors"><Icon name="x" size={24}/></button>
                            <h2 className="text-2xl font-bold text-slate-800 mb-6">Informaci칩n Legal</h2>
                            <div className="flex gap-2 mb-6 border-b border-slate-100 pb-1 overflow-x-auto">
                                <button onClick={() => setLegalTab('terms')} className={`px-4 py-2 font-bold text-sm rounded-t-lg transition-colors whitespace-nowrap ${legalTab === 'terms' ? 'text-farmacia-green bg-green-50' : 'text-slate-400 hover:text-slate-600'}`}>T칠rminos</button>
                                <button onClick={() => setLegalTab('privacy')} className={`px-4 py-2 font-bold text-sm rounded-t-lg transition-colors whitespace-nowrap ${legalTab === 'privacy' ? 'text-farmacia-green bg-green-50' : 'text-slate-400 hover:text-slate-600'}`}>Privacidad</button>
                                <button onClick={() => setLegalTab('disclaimers')} className={`px-4 py-2 font-bold text-sm rounded-t-lg transition-colors whitespace-nowrap ${legalTab === 'disclaimers' ? 'text-farmacia-green bg-green-50' : 'text-slate-400 hover:text-slate-600'}`}>Descargos</button>
                            </div>
                            <div className="overflow-y-auto flex-1 text-sm text-slate-600 leading-relaxed pr-2 whitespace-pre-line">{contents[legalTab]}</div>
                            <Button className="mt-8" variant="outline" onClick={() => setActiveModal(null)}>Entendido</Button>
                        </div>
                    </div>
                );
            };

            const CommunityModal = () => {
                if (activeModal !== 'community') return null;
                return (
                    <div className="fixed inset-0 z-50 bg-slate-900/60 backdrop-blur-sm flex items-center justify-center p-4 animate-fade-in">
                        <div className="bg-white rounded-3xl w-full max-w-sm p-8 relative shadow-2xl text-center">
                            <button onClick={() => setActiveModal(null)} className="absolute top-6 right-6 text-slate-400 hover:text-slate-800"><Icon name="x" size={24}/></button>
                            <div className="w-16 h-16 bg-blue-50 text-blue-500 rounded-full flex items-center justify-center mx-auto mb-4 text-3xl"><Icon name="users" /></div>
                            <h2 className="text-xl font-bold mb-2 text-slate-800">Comunidad de Estudio</h2>
                            
                            <div className="bg-slate-50 border border-slate-100 rounded-xl p-4 mb-6 text-left">
                                <h4 className="text-xs font-bold text-slate-500 uppercase mb-2">Reglas de Buena Convivencia</h4>
                                <ul className="text-xs text-slate-600 space-y-1 list-disc pl-4">
                                    <li>Tratar con respeto a todos los colegas.</li>
                                    <li>No compartir publicidad ni spam.</li>
                                    <li>Enfocarse en temas de estudio y trabajo.</li>
                                    <li className="text-red-500 font-bold">El uso de malos tratos ser치 causal de eliminaci칩n inmediata.</li>
                                </ul>
                            </div>

                            <div className="space-y-3">
                                <a href="https://chat.whatsapp.com/IPvHmnNGWYmH61FrdV56g1" className="w-full bg-[#25D366] text-white py-3.5 rounded-xl font-bold flex items-center justify-center gap-3 hover:opacity-90 transition-opacity shadow-lg shadow-green-100"><Icon name="whatsapp" size={24} /> Grupo de WhatsApp</a>
                                <a href="https://www.facebook.com/share/g/1AFb8riMpT/" className="w-full bg-[#1877F2] text-white py-3.5 rounded-xl font-bold flex items-center justify-center gap-3 hover:opacity-90 transition-opacity shadow-lg shadow-blue-100"><Icon name="facebook" size={24} /> Grupo de Facebook</a>
                            </div>

                            <div className="mt-6">
                                <Button variant="outline" fullWidth onClick={() => setActiveModal(null)}>Volver</Button>
                            </div>
                        </div>
                    </div>
                );
            };

            return (
                <div className="w-full max-w-md bg-white h-screen md:h-[90vh] md:rounded-3xl md:shadow-2xl overflow-hidden flex flex-col relative">
                    {view === 'LANDING' && renderLanding()}
                    {view === 'DASHBOARD' && renderDashboard()}
                    {view === 'LIBRARY' && renderLibrary()}
                    {view === 'FAQS' && renderFAQs()}
                    {view === 'BLOG' && renderBlog()}
                    {view === 'ARTICLE' && renderArticle()}
                    {renderQuizModal()}
                    <AuthModal />
                    <LegalModal />
                    <CommunityModal />
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
